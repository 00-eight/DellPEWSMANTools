{
    "Initialization" : {
        "Command" : "New-PEDRACSession",
        "Parameters" : [
            {
                "Name" : "Credential",
                "Type" : "PSCredential"
            },
            {
                "Name" : "IPAddress",
                "Type" : "String"
            }
        ],
        "OutputObject" : "Session"
    },
    "Objects" : {
        "System" : {
            "Get" : {
                "Command" : "Get-PESystemInformation",
                "Input" : [
                    {
                        "ParameterName" : "iDRACSession",
                        "Value" : "Session",
                        "Type" : "Variable"
                    }
                ]
            }
        },
        "Processor" : {
            "Get" : {
                "Command" : " Get-PECPU",
                "Input" : [
                    {
                        "ParameterName" : "iDRACSession",
                        "Value" : "Session",
                        "Type" : "Variable"
                    }
                ]
            }
        },
        "Memory" : {
            "Get" : {
                "Command" : " Get-PEMemory",
                "Input" : [
                    {
                        "ParameterName" : "iDRACSession",
                        "Value" : "Session",
                        "Type" : "Variable"
                    }
                ]
            }
        },        
        "Network" : {
            "Get" : {
                "Command" : "Get-PENetworkDevice",
                "Input" : [
                    {
                        "ParameterName" : "iDRACSession",
                        "Value" : "Session",
                        "Type" : "Variable"
                    }
                ]
            }
        },
        "DiskStorage" : {
            "Get" : {
                "Command" : "Get-PEStorageController",
                "Input" : [
                    {
                        "ParameterName" : "iDRACSession",
                        "Value" : "Session",
                        "Type" : "Variable"
                    }
                ]
            }
        },
        "PhysicalDisk" : {
            "Get" : {
                "Command" : "Get-PEPhysicalDisk",
                "Input" : [
                    {
                        "ParameterName" : "iDRACSession",
                        "Value" : "Session",
                        "Type" : "Variable"
                    }
                ]
            }
        },
        "PCIeStorage" : {
            "Get" : {
                "Command" : "Get-PEPCIeSSDExtender",
                "Input" : [
                    {
                        "ParameterName" : "iDRACSession",
                        "Value" : "Session",
                        "Type" : "Variable"
                    }
                ]
            }
        },        
        "PCIeDisk" : {
            "Get" : {
                "Command" : "Get-PEPhysicalDisk",
                "Input" : [
                    {
                        "ParameterName" : "iDRACSession",
                        "Value" : "Session",
                        "Type" : "Variable"
                    },
                    {
                        "ParameterName" : "BusProtocol",
                        "Value" : "PCIe",
                        "Type" : "String"
                    }
                ]
            }
        },
        "DRAC" : {
            "Get" : {
                "Command" : "Get-PEDRACInformation",
                "Input" : [
                    {
                        "ParameterName" : "iDRACSession",
                        "Value" : "Session",
                        "Type" : "Variable"
                    }
                ]
            }
        },
        "PowerSupply" : {
            "Get" : {
                "Command" : "Get-PEPowerSupply",
                "Input" : [
                    {
                        "ParameterName" : "iDRACSession",
                        "Value" : "Session",
                        "Type" : "Variable"
                    }
                ]
            }
        },
        "Enclosure" : {
            "Get" : {
                "Command" : "Get-PEEnclosure",
                "Input" : [
                    {
                        "ParameterName" : "iDRACSession",
                        "Value" : "Session",
                        "Type" : "Variable"
                    }
                ]
            }            
        }
    },
    "Configuration" : {
        "BIOSConfiguration" : {
            "Get" : {
                "Command" : "Get-PEBIOSAttribute",
                "Input" : [
                    {
                        "ParameterName" : "iDRACSession",
                        "Value" : "Session"
                    }
                ]
            },
            "Groups" : {
                "Processor Settings" : [
                    "Logical Processor",
                    "Virtualization Technology",
                    "Dell Controlled Turbo"
                ],
                "Boot Settings" : [
                    "Boot Mode",
                    "Boot Sequence Retry"
                ],
                "PXE Device1 Settings" : [
                    "Interface",
                    "Protocol",
                    "VLAN"
                ],
                "System Profile Settings" : [
                    "C States",
                    "C1E",
                    "System Profile"
                ]
            }
        },
        "DRACConfiguration" : {
            "Get" : {
                "Command" : "Get-PEDRACAttribute",
                "Input" : [
                    {
                        "ParameterName" : "iDRACSession",
                        "Value" : "Session"
                    }
                ]
            },
            "Groups" : {
                "IPMI LAN Information" : [
                    "Enable or Disable IPMI over LAN"
                ],
                "NIC Information" : [
                    "NIC Enable",
                    "NIC Selection",
                    "NIC Failover",
                    "Enable VLAN"
                ],
                "IPv4 Information" : [
                    "IPv4 Enable",
                    "IPv4 DHCP Enable",
                    "DNS Servers From DHCP"
                ],
                "IPv6 Information" : [
                    "IPV6 Enable",
                    "IPV6 Auto Config",
                    "DNS Server From DHCP6",
                    "Address State"
                ]
            }
        }
    },    
    "Formatter" : {
        "System" : {
            "IsRoot" : 1,
            "IsChild" : 0,
            "IsArray" : 0,
            "SelectorSet" : {
                "Properties" : [
                    "ServiceTag",
                    "Model",
                    "@{l='TotalMemoryGB';e={$_.SysMemTotalSize/1024}}",
                    "@{l='BIOS';e={$_.BIOSVersionString}}",
                    "@{l='CPLD';e={$_.CPLDVersion}}",
                    "@{l='LCVersion';e={$_.LifecycleControllerVersion}}"
                ],
                "Qualifiers" : {
                    
                }
            }         
        },
        "Processor" : {
            "IsChild" : 1,
            "IsArray" : 0,            
            "Parent" : "System",
            "SelectorSet" : {
                "Properties" : [
                    "Model",
                    "NumberOfProcessorCores"    
                ],
                "Qualifiers" : {
                    "UniqueOnly" : 1,
                    "PreSelect" : 0,
                    "Aggregate" : {
                        "By" : "InstanceCount",
                        "PropertyName" : "CPUCount"
                    }
                }
            }
        },
        "Memory" : {
            "IsArray" : 0,
            "IsChild" : 1,
            "Parent" : "System",
            "SelectorSet" : {
                "Properties" : [
                    "Model",
                    "Speed"   ,
                    "Size"
                ],
                "Qualifiers" : {
                    "UniqueOnly" : 1,
                    "PreSelect" : 0,
                    "Aggregate" : {
                        "By" : "InstanceCount",
                        "PropertyName" : "DIMMCount"
                    }
                }
            }
        },
        "Network" : {
            "IsArray" : 1,
            "IsChild" : 1,
            "Parent" : "System",
            "SelectorSet" : {
                "Properties" : [
                    "@{l='ProductName';e={($_.ProductName.Remove($_.ProductName.LastIndexOf('-'))).Trim()}}",
                    "FamilyVersion",
                    "PermanentMACAddress",
                    "@{l='Slot';e={if($pcieSlottype -Contains $_.SlotType){($_.InstanceID.Split('.'))[2].Split('-')[0]}else{'Embedded'}}}"
                ],
                "Qualifiers" : {
                    "UniqueOnly" : 0
                }
            }            
        },
        "DiskStorage" : {
            "IsArray" : 1,
            "IsChild" :1,
            "Parent" : "System",
            "Related" : [
                {
                    "RelatedObject" : "PhysicalDisk",
                    "RelatedBy" : "FQDD",
                    "IsArray" : 1,
                    "IsChild" : 1,
                    "SelectorSet" : {
                        "Properties" : [
                            "Model",
                            "Revision",
                            "SerialNumber",
                            "Slot",
                            "@{l='ConnectedTo';e={$_.FQDD.Substring($_.FQDD.LastIndexOf(':')+1)}}"
                        ],
                        "Qualifiers" : {
                            "PreSelect" : 0    
                        }
                    }            
                }                    
            ],            
            "SelectorSet" : {
                "Properties" : [
                    "ProductName",
                    "ControllerFirmwareVersion",
                    "@{l='Slot';e={$_.PCISlot}}",
                    "@{l='DiskCount';e={$fqdd=$_.FQDD;((Get-PEPhysicalDisk -iDracSession $Session).Where({$_.FQDD.Substring($_.FQDD.LastIndexOf(':')+1) -eq $fqdd})).Count}}"
                ],
                "Qualifiers" : {
                    "UniqueOnly" : 1,
                    "PreSelect" : 1
                }
            }                        
        },
        "PCIeStorage" : {
            "IsArray" : 1,
            "IsChild" :1,
            "Parent" : "System",
            "Related" : [
                {
                    "RelatedObject" : "PCIeDisk",
                    "RelatedBy" : "FQDD",
                    "IsArray" : 1,
                    "IsChild" : 1,
                    "SelectorSet" : {
                        "Properties" : [
                            "Model",
                            "Revision",
                            "SerialNumber",
                            "@{l='Slot';e={$_.DeviceDescription.SubString($_.DeviceDescription.IndexOf('Slot')+5,2)}}",
                            "@{l='ConnectedTo';e={$_.FQDD.Substring($_.FQDD.LastIndexOf(':')+1)}}"
                        ],
                        "Qualifiers" : {
                            "PreSelect" : 0    
                        }
                    }            
                }                    
            ],            
            "SelectorSet" : {
                "Properties" : [
                    "DeviceDescription",
                    "FQDD",
                    "@{l='Slot';e={$_.FQDD.Substring($_.FQDD.LastIndexOf('.')+1)}}",
                    "@{l='DiskCount';e={$fqdd=$_.FQDD;((Get-PEPhysicalDisk -iDracSession $Session).Where({$_.FQDD.Substring($_.FQDD.LastIndexOf(':')+1) -eq $fqdd})).Count}}"
                ],
                "Qualifiers" : {
                    "UniqueOnly" : 1,
                    "PreSelect" : 1
                }
            }                        
        },
        "DRAC" :{
            "IsArray" : 0,
            "IsChild" : 1,
            "Parent" : "System",            
            "SelectorSet" : {
                "Properties" :[
                    "Model",
                    "FirmwareVersion",
                    "PermanentMACAddress"
                ],
                "Qualifiers" : {
                    "PreSelect" : 0
                }
            }            
        },
        "PowerSupply" : {
            "IsArray" : 0,
            "IsChild" : 1,
            "Parent" : "System",            
            "SelectorSet" : {
                "Properties" :[
                    "@{l='Model';e={($_.Model).Trim()}}",
                    "FirmwareVersion"
                ],
                "Qualifiers" : {
                    "UniqueOnly" : 1,                    
                    "PreSelect" : 0,
                    "Aggregate" : {
                        "By" : "InstanceCount",
                        "PropertyName" : "PSUCount"
                    }                    
                }
            }             
        },
        "Enclosure" : {
            "IsArray" : 1,
            "IsChild" : 1,
            "Parent" : "System",
            "SelectorSet" : {
                "Properties" :[
                    "ProductName",
                    "Version",
                    "SlotCount",
                    "@{l='ConnectedDevice';e={$_.FQDD.Substring($_.FQDD.LastIndexOf(':')+1)}}"
                ],
                "Qualifiers" : {
                    "PreSelect" : 0
                }
            }            
        },
        "BIOSConfiguration" : {
            "IsArray" : 0,
            "SelectorSet" : {
                "Properties" : [
                    "AttributeDisplayName",
                    "CurrentValue"
                ]
            }
        },
        "DRACConfiguration" : {
            "IsArray" : 0,
            "SelectorSet" : {
                "Properties" : [
                    "AttributeDisplayName",
                    "CurrentValue"
                ]
            }
        }
    },
    "Comparer" : {
        "System" : {
           "MustMatch" :[
               "Model"
           ],
           "NoMatchAction" : "Halt",         
           "Optional" : [
                "TotalMemoryGB",
                "BIOS",
                "CPLD",
                "LCVersion"               
            ]
        },
        "Processor" : {
            "MustMatch" : [
                "Model",
                "CPUCount"
            ],
            "NoMatchAction" : "ReportError"
        },
        "Memory" : {
            "MustMatch" : [
                "Model",
                "Speed",
                "Size",
                "DIMMCount"
            ],
            "NoMatchAction" : "ReportError"
        }
    }
}